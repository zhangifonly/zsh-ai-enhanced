# iZsh å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

## âŒ é—®é¢˜ 1: Library not loaded: @rpath/libcurl.4.dylib

### é”™è¯¯ä¿¡æ¯
```
dyld[46177]: Library not loaded: @rpath/libcurl.4.dylib
  Referenced from: <...> /Users/zhangzhen/.local/bin/izsh
  Reason: no LC_RPATH's found
zsh: abort      ~/.local/bin/izsh
```

### åŸå› 
izsh ç¼–è¯‘æ—¶é“¾æ¥äº† libcurl åº“ï¼Œä½†è¿è¡Œæ—¶ç³»ç»Ÿæ‰¾ä¸åˆ°è¯¥åº“æ–‡ä»¶ã€‚

### âœ… è§£å†³æ–¹æ¡ˆ

#### æ–¹æ³• 1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰â­
```bash
cd ~/Documents/ClaudeCode/zsh/zsh
./start_izsh.sh
```

å¯åŠ¨è„šæœ¬ä¼šè‡ªåŠ¨è®¾ç½®æ­£ç¡®çš„ç¯å¢ƒå˜é‡ã€‚

#### æ–¹æ³• 2: æ‰‹åŠ¨è®¾ç½®ç¯å¢ƒå˜é‡
```bash
export DYLD_LIBRARY_PATH=/Users/zhangzhen/anaconda3/lib
~/.local/bin/izsh
```

#### æ–¹æ³• 3: æ°¸ä¹…é…ç½®ï¼ˆä¿®æ”¹ ~/.zshrcï¼‰
åœ¨æ‚¨çš„ `~/.zshrc` ä¸­æ·»åŠ ï¼š
```bash
# ä¸º izsh è®¾ç½®åº“è·¯å¾„
alias izsh='DYLD_LIBRARY_PATH=/Users/zhangzhen/anaconda3/lib ~/.local/bin/izsh'
```

ç„¶åé‡æ–°åŠ è½½é…ç½®ï¼š
```bash
source ~/.zshrc
```

ä¹‹åå°±å¯ä»¥ç›´æ¥è¿è¡Œï¼š
```bash
izsh
```

---

## âŒ é—®é¢˜ 2: åœ¨æ ‡å‡† zsh ä¸­æ— æ³•åŠ è½½ ai æ¨¡å—

### é”™è¯¯ä¿¡æ¯
```
zsh: failed to load module `zsh/ai': dlopen(/usr/lib/zsh/5.9/zsh/ai.so, 0x0009): tried: '/usr/lib/zsh/5.9/zsh/ai.so' (no such file)
```

### åŸå› 
**é‡è¦è¯´æ˜**ï¼š`ai` æ¨¡å—æ˜¯ä¸“é—¨ä¸º **iZsh** ç¼–è¯‘çš„ï¼Œ**ä¸èƒ½åœ¨æ ‡å‡† zsh ä¸­ä½¿ç”¨**ï¼

- æ ‡å‡† zsh: `/bin/zsh` æˆ– `/usr/bin/zsh` â†’ âŒ ä¸æ”¯æŒ ai æ¨¡å—
- iZsh: `~/.local/bin/izsh` â†’ âœ… æ”¯æŒ ai æ¨¡å—

### âœ… è§£å†³æ–¹æ¡ˆ

**å¿…é¡»å…ˆå¯åŠ¨ iZsh**ï¼Œç„¶åæ‰èƒ½åŠ è½½ ai æ¨¡å—ï¼š

```bash
# 1. å¯åŠ¨ iZshï¼ˆä¸æ˜¯æ ‡å‡† zshï¼ï¼‰
DYLD_LIBRARY_PATH=/Users/zhangzhen/anaconda3/lib ~/.local/bin/izsh

# 2. åœ¨ iZsh ä¸­åŠ è½½ ai æ¨¡å—
zmodload zsh/ai

# 3. ä½¿ç”¨ AI åŠŸèƒ½
ai "ä½ çš„é—®é¢˜"
```

**æˆ–è€…ä½¿ç”¨å¯åŠ¨è„šæœ¬**ï¼ˆæ›´ç®€å•ï¼‰ï¼š
```bash
./start_izsh.sh
# ç„¶åæ‰§è¡Œï¼š
zmodload zsh/ai
ai "Hello!"
```

---

## ğŸ¯ æ­£ç¡®çš„ä½¿ç”¨æµç¨‹

### ç¬¬ä¸€æ¬¡ä½¿ç”¨

1. **æµ‹è¯• AI åŠŸèƒ½**ï¼ˆè‡ªåŠ¨æ¼”ç¤ºï¼‰ï¼š
```bash
cd ~/Documents/ClaudeCode/zsh/zsh
./test_ai_simple.sh
```

2. **äº¤äº’å¼ä½¿ç”¨**ï¼š
```bash
./start_izsh.sh
```

3. **åœ¨ iZsh ä¸­**ï¼š
```bash
zmodload zsh/ai
ai "What is Docker?"
```

### æ—¥å¸¸ä½¿ç”¨

#### é€‰é¡¹ A: æ¯æ¬¡æ‰‹åŠ¨å¯åŠ¨
```bash
cd ~/Documents/ClaudeCode/zsh/zsh
./start_izsh.sh
zmodload zsh/ai
ai "ä½ çš„é—®é¢˜"
```

#### é€‰é¡¹ B: é…ç½®åˆ«åï¼ˆæ¨èï¼‰
åœ¨ `~/.zshrc` ä¸­æ·»åŠ ï¼š
```bash
# iZsh åˆ«å
alias izsh='DYLD_LIBRARY_PATH=/Users/zhangzhen/anaconda3/lib ~/.local/bin/izsh'

# å¿«é€Ÿå¯åŠ¨è„šæœ¬åˆ«å
alias izsh-start='~/Documents/ClaudeCode/zsh/zsh/start_izsh.sh'
```

é‡æ–°åŠ è½½ï¼š
```bash
source ~/.zshrc
```

ä¹‹åå°±å¯ä»¥ï¼š
```bash
izsh          # å¯åŠ¨ iZsh
izsh-start    # ä½¿ç”¨å¯åŠ¨è„šæœ¬
```

---

## ğŸ” å¦‚ä½•åŒºåˆ† iZsh å’Œæ ‡å‡† zsh

### æ£€æŸ¥å½“å‰ shell
```bash
# æŸ¥çœ‹ç‰ˆæœ¬
echo $ZSH_VERSION

# iZsh ä¼šæ˜¾ç¤ºï¼š
1.0.0-izsh

# æ ‡å‡† zsh ä¼šæ˜¾ç¤ºï¼š
5.9
```

### æ£€æŸ¥æç¤ºç¬¦
iZsh çš„æç¤ºç¬¦ä¼šæ˜¾ç¤ºï¼š
```
[iZsh] user@hostname:~%
```

æ ‡å‡† zsh çš„æç¤ºç¬¦é€šå¸¸æ˜¯ï¼š
```
user@hostname:~%
```

---

## ğŸ“‹ å¿«é€Ÿå‚è€ƒ

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| **æµ‹è¯• AI åŠŸèƒ½** | `./test_ai_simple.sh` |
| **å¯åŠ¨ iZsh** | `./start_izsh.sh` |
| **æ‰‹åŠ¨å¯åŠ¨** | `DYLD_LIBRARY_PATH=/Users/zhangzhen/anaconda3/lib ~/.local/bin/izsh` |
| **åŠ è½½ AI æ¨¡å—** | `zmodload zsh/ai` ï¼ˆä»…åœ¨ iZsh ä¸­ï¼‰ |
| **ä½¿ç”¨ AI** | `ai "ä½ çš„é—®é¢˜"` |
| **æŸ¥çœ‹ç‰ˆæœ¬** | `echo $ZSH_VERSION` |
| **é€€å‡º iZsh** | `exit` æˆ– `Ctrl+D` |

---

## ğŸ› ï¸ ç¯å¢ƒæ£€æŸ¥æ¸…å•

è¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ç¯å¢ƒæ˜¯å¦æ­£ç¡®ï¼š

```bash
# 1. æ£€æŸ¥ izsh æ˜¯å¦å­˜åœ¨
ls -lh ~/.local/bin/izsh
# åº”è¯¥æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯

# 2. æ£€æŸ¥ libcurl æ˜¯å¦å­˜åœ¨
ls -lh /Users/zhangzhen/anaconda3/lib/libcurl.4.dylib
# åº”è¯¥æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯

# 3. æ£€æŸ¥ ai æ¨¡å—æ˜¯å¦å­˜åœ¨
ls -lh ~/.local/lib/izsh/1.0.0-izsh/zsh/ai.so
# åº”è¯¥æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯

# 4. æµ‹è¯• izsh ç‰ˆæœ¬ï¼ˆå¸¦ç¯å¢ƒå˜é‡ï¼‰
DYLD_LIBRARY_PATH=/Users/zhangzhen/anaconda3/lib ~/.local/bin/izsh --version
# åº”è¯¥æ˜¾ç¤º: zsh 1.0.0-izsh (arm-apple-darwin25.1.0)
```

æ‰€æœ‰æ£€æŸ¥éƒ½é€šè¿‡ï¼Œè¯´æ˜ç¯å¢ƒé…ç½®æ­£ç¡®ï¼âœ…

---

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### 1. é…ç½®åˆ«åï¼ˆä¸€æ¬¡é…ç½®ï¼Œæ°¸ä¹…ä½¿ç”¨ï¼‰

ç¼–è¾‘ `~/.zshrc`ï¼š
```bash
# iZsh é…ç½®
export IZSH_LIB_PATH=/Users/zhangzhen/anaconda3/lib
alias izsh='DYLD_LIBRARY_PATH=$IZSH_LIB_PATH ~/.local/bin/izsh'

# å¿«é€Ÿå¯åŠ¨
alias izsh-start='~/Documents/ClaudeCode/zsh/zsh/start_izsh.sh'
alias izsh-test='~/Documents/ClaudeCode/zsh/zsh/test_ai_simple.sh'
```

### 2. åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼

åˆ›å»ºæ–‡ä»¶ `~/Desktop/iZsh.command`ï¼š
```bash
#!/bin/bash
cd ~/Documents/ClaudeCode/zsh/zsh
./start_izsh.sh
```

æ·»åŠ æ‰§è¡Œæƒé™ï¼š
```bash
chmod +x ~/Desktop/iZsh.command
```

åŒå‡»æ¡Œé¢å›¾æ ‡å³å¯å¯åŠ¨ iZshï¼

### 3. è‡ªåŠ¨åŠ è½½ AI æ¨¡å—

ç¼–è¾‘ `~/.izshrc`ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š
```bash
# è‡ªåŠ¨åŠ è½½ AI æ¨¡å—
if [[ "$ZSH_VERSION" == "1.0.0-izsh" ]]; then
    zmodload zsh/ai 2>/dev/null
    echo "âœ… AI æ¨¡å—å·²è‡ªåŠ¨åŠ è½½ï¼Œä½¿ç”¨ 'ai' å‘½ä»¤å¼€å§‹å¯¹è¯"
fi
```

ä¹‹åæ¯æ¬¡å¯åŠ¨ iZshï¼ŒAI æ¨¡å—ä¼šè‡ªåŠ¨åŠ è½½ï¼

---

## â“ ä»ç„¶é‡åˆ°é—®é¢˜ï¼Ÿ

### è·å–è¯¦ç»†è°ƒè¯•ä¿¡æ¯
```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
DYLD_LIBRARY_PATH=/Users/zhangzhen/anaconda3/lib \
DYLD_PRINT_LIBRARIES=1 \
~/.local/bin/izsh -c 'echo "iZsh started"'
```

è¿™ä¼šæ˜¾ç¤ºæ‰€æœ‰åŠ è½½çš„åŠ¨æ€åº“ï¼Œå¸®åŠ©è¯Šæ–­é—®é¢˜ã€‚

### æ£€æŸ¥é…ç½®æ–‡ä»¶
```bash
# æŸ¥çœ‹ iZsh é…ç½®
cat ~/.izshrc

# æŸ¥çœ‹ AI æ¨¡å—é…ç½®
grep IZSH_AI ~/.izshrc
```

### é‡æ–°ç¼–è¯‘ï¼ˆæœ€åæ‰‹æ®µï¼‰
```bash
cd ~/Documents/ClaudeCode/zsh/zsh
make clean
make
make install.bin install.modules
```

---

**è®°ä½å…³é”®ç‚¹**ï¼š
1. âœ… å¿…é¡»å…ˆå¯åŠ¨ **iZsh**ï¼ˆä¸æ˜¯æ ‡å‡† zshï¼‰
2. âœ… éœ€è¦è®¾ç½® **DYLD_LIBRARY_PATH** ç¯å¢ƒå˜é‡
3. âœ… AI æ¨¡å—åªèƒ½åœ¨ **iZsh** ä¸­ä½¿ç”¨
4. âœ… ä½¿ç”¨ **å¯åŠ¨è„šæœ¬** æœ€ç®€å•ï¼

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰
